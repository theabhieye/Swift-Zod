#!/bin/sh
set -e

echo "→ Running SwiftLint pre-commit check..."

# Move to repo root regardless of where commit is run from
cd "$(git rev-parse --show-toplevel)"

if command -v swiftlint >/dev/null 2>&1; then
    # Run SwiftLint normally
    swiftlint
    EXIT_CODE=$?
else
    echo "SwiftLint not installed. Install via: brew install swiftlint"
    exit 1
fi

if [ $EXIT_CODE -ne 0 ]; then
    echo "✖ Commit blocked due to SwiftLint violations."
    exit 1
fi

echo "✔ SwiftLint passed. Proceeding with commit."
exit 0
